labs(title = "Characterising rust resistance assay scores",
subtitle="Coloured by number of seedlings assayed",
y = "Seed lot ID",
x = "Raw assay score",
fill = "Number assayed") +
theme_bw() +
scale_fill_viridis_c()
observe(
# selected_seedlots=NULL; selected_seedlots$seedlot_ID <- unique(mat_line_genompred_score$Seedlot)[1:5]
selected_seedlot_rustassay_score_allrepo <- left_join(mat_line_rustassay_score, LoadedinData) %>%
dplyr::filter(Seedlot %in% selected_seedlots$seedlot_ID)
mean_matLine_RustAssay <- selected_seedlot_rustassay_score_allrepo %>%
mean_matLine_RustAssay <- selected_seedlot_rustassay_score_allrepo %>%
dplyr::select(seedlot, Mean_seedling_score_rustassay) %>%
dplyr::distinct()
mean_matLine_RustAssay <- selected_seedlot_rustassay_score_allrepo %>%
dplyr::select(Seedlot, Mean_seedling_score_rustassay) %>%
dplyr::distinct()
ggplot() +
geom_density_ridges2(data=selected_seedlot_rustassay_score_allrepo, colour="grey40", aes(x = Seedling_score_rustassay, y=Seedlot, fill=Seedling_number_rustassay)) +
geom_vline(data = mean_matLine_RustAssay, aes(xintercept = Mean_seedling_score_rustassay), colour = "red", linewidth = 2, linetype="dashed") +
labs(title = "Characterising rust resistance assay scores",
subtitle="Coloured by number of seedlings assayed",
y = "Seed lot ID",
x = "Raw assay score",
fill = "Number assayed") +
theme_bw() +
scale_fill_viridis_c()
observe(
# selected_seedlots=NULL; selected_seedlots$seedlot_ID <- unique(mat_line_genompred_score$Seedlot)[1:5]
selected_seedlot_rustassay_score_allrepo <- left_join(mat_line_rustassay_score, LoadedinData) %>%
dplyr::filter(Seedlot %in% selected_seedlots$seedlot_ID)
mean_matLine_RustAssay <- selected_seedlot_rustassay_score_allrepo %>%
ggplot() +
geom_density_ridges2(data=selected_seedlot_rustassay_score_allrepo, colour="grey40", aes(x = Seedling_score_rustassay, y=Seedlot, fill=Seedling_number_rustassay)) +
geom_segment(data = mean_matLine_RustAssay, aes(x = Mean_seedling_score_rustassay, xend = Mean_seedling_score_rustassay, y = as.numeric(factor(Seedlot)) - 0.4, yend = as.numeric(factor(Seedlot)) + 0.4), colour = "red", linewidth = 0.5, linetype="dashed") +
labs(title = "Characterising rust resistance assay scores",
subtitle="Coloured by number of seedlings assayed",
y = "Seed lot ID",
x = "Raw assay score",
fill = "Number assayed") +
theme_bw() +
scale_fill_viridis_c()
ggplot() +
geom_density_ridges2(data=selected_seedlot_rustassay_score_allrepo, colour="grey40", aes(x = Seedling_score_rustassay, y=Seedlot, fill=Seedling_number_rustassay)) +
geom_segment(data = mean_matLine_RustAssay, aes(x = Mean_seedling_score_rustassay, xend = Mean_seedling_score_rustassay, y = as.numeric(factor(Seedlot)), yend = as.numeric(factor(Seedlot)) + 0.8), colour = "red", linewidth = 0.5, linetype="dashed") +
labs(title = "Characterising rust resistance assay scores",
subtitle="Coloured by number of seedlings assayed",
y = "Seed lot ID",
x = "Raw assay score",
fill = "Number assayed") +
theme_bw() +
scale_fill_viridis_c()
ggplot() +
geom_density_ridges2(data=selected_seedlot_rustassay_score_allrepo, colour="grey40", aes(x = Seedling_score_rustassay, y=Seedlot, fill=Seedling_number_rustassay)) +
geom_segment(data = mean_matLine_RustAssay, aes(x = Mean_seedling_score_rustassay, xend = Mean_seedling_score_rustassay, y = as.numeric(factor(Seedlot)), yend = as.numeric(factor(Seedlot)) + 1), colour = "red", linewidth = 0.5, linetype="dashed") +
labs(title = "Characterising rust resistance assay scores",
subtitle="Coloured by number of seedlings assayed",
y = "Seed lot ID",
x = "Raw assay score",
fill = "Number assayed") +
theme_bw() +
scale_fill_viridis_c()
ggplot() +
geom_density_ridges2(data=selected_seedlot_rustassay_score_allrepo, colour="grey40", aes(x = Seedling_score_rustassay, y=Seedlot, fill=Seedling_number_rustassay)) +
geom_segment(data = mean_matLine_RustAssay, aes(x = Mean_seedling_score_rustassay, xend = Mean_seedling_score_rustassay, y = as.numeric(factor(Seedlot)) + 0.4, yend = as.numeric(factor(Seedlot)) + 1), colour = "red", linewidth = 0.5, linetype="dashed") +
labs(title = "Characterising rust resistance assay scores",
subtitle="Coloured by number of seedlings assayed",
y = "Seed lot ID",
x = "Raw assay score",
fill = "Number assayed") +
theme_bw() +
scale_fill_viridis_c()
ggplot() +
geom_density_ridges2(data=selected_seedlot_rustassay_score_allrepo, colour="grey40", aes(x = Seedling_score_rustassay, y=Seedlot, fill=Seedling_number_rustassay)) +
geom_segment(data = mean_matLine_RustAssay, aes(x = Mean_seedling_score_rustassay, xend = Mean_seedling_score_rustassay, y = as.numeric(factor(Seedlot)) + 0.2, yend = as.numeric(factor(Seedlot)) + 0.8), colour = "red", linewidth = 0.5, linetype="dashed") +
labs(title = "Characterising rust resistance assay scores",
subtitle="Coloured by number of seedlings assayed",
y = "Seed lot ID",
x = "Raw assay score",
fill = "Number assayed") +
theme_bw() +
scale_fill_viridis_c()
observe(
# selected_seedlots=NULL; selected_seedlots$seedlot_ID <- unique(mat_line_genompred_score$Seedlot)[1:5]
selected_seedlot_rustassay_score_allrepo <- left_join(mat_line_rustassay_score, LoadedinData) %>%
dplyr::filter(Seedlot %in% selected_seedlots$seedlot_ID)
mean_matLine_RustAssay <- selected_seedlot_rustassay_score_allrepo %>%
View(mean_matLine_RustAssay)
View(selected_seedlot_rustassay_score_allrepo)
View(selected_seedlot_rustassay_score_allrepo)
## Plot of seedlots characteristics
observe(
# selected_seedlots=NULL; selected_seedlots$seedlot_ID <- unique(mat_line_genompred_score$Seedlot)[1:5]
selected_seedlot_rustassay_score_allrepo <- left_join(mat_line_rustassay_score, LoadedinData) %>%
dplyr::filter(Seedlot %in% selected_seedlots$seedlot_ID),
mean_matLine_RustAssay <- selected_seedlot_rustassay_score_allrepo %>%
dplyr::select(Seedlot, Mean_seedling_score_rustassay) %>%
dplyr::distinct(),
selected_seedlot_genompred_score_allrepo <- left_join(mat_line_genompred_score, LoadedinData) %>%
dplyr::filter(Seedlot %in% selected_seedlots$seedlot_ID),
mean_matLine_GenomPred <- selected_seedlot_rustassay_score_allrepo %>%
dplyr::select(Seedlot, Mean_seedling_score_genompred) %>%
dplyr::distinct(),
mean_matLine_MatLineGenomPred <- selected_seedlot_rustassay_score_allrepo %>%
dplyr::select(Seedlot, MatLine_Genompred) %>%
dplyr::distinct(),
output$seedlot_plot_geomridge <- ggplot() +
geom_density_ridges2(data=selected_seedlot_rustassay_score_allrepo, colour="grey40", aes(x = Seedling_score_rustassay, y=Seedlot, fill=Seedling_number_rustassay)) +
geom_segment(data = mean_matLine_RustAssay, aes(x = Mean_seedling_score_rustassay, xend = Mean_seedling_score_rustassay, y = as.numeric(factor(Seedlot)) + 0.2, yend = as.numeric(factor(Seedlot)) + 0.8), colour = "red", linewidth = 0.5, linetype="dashed") +
labs(title = "Characterising rust resistance assay scores",
subtitle="Red dashed line represents mean seedling rust assay score of seed lot",
y = "Seed lot ID",
x = "Raw assay score",
fill = "Number assayed") +
theme_bw() +
scale_fill_viridis_c(),
output$seedlot_plot_geomridge <- ggplot() +
geom_density_ridges2(data=selected_seedlot_rustassay_score_allrepo, colour="grey40", aes(x = Seedling_score_rustassay, y=Seedlot, fill=Seedling_number_rustassay)) +
geom_segment(data = mean_matLine_GenomPred, aes(x = Mean_seedling_score_genompred, xend = Mean_seedling_score_genompred, y = as.numeric(factor(Seedlot)) + 0.2, yend = as.numeric(factor(Seedlot)) + 0.8), colour = "orchid", linewidth = 0.5, linetype="dashed") +
geom_segment(data = mean_matLine_MatLineGenomPred, aes(x = MatLine_Genompred, xend = MatLine_Genompred, y = as.numeric(factor(Seedlot)) + 0.2, yend = as.numeric(factor(Seedlot)) + 0.8), colour = "blue", linewidth = 0.5, linetype="dashed") +
labs(title = "Characterising rust resistance assay scores",
subtitle="Blue dashed line represents mean seedling genomic prediction score of seed lot\n Purple dashed line represents the maternal line's genomic prediction score",
y = "Seed lot ID",
x = "Raw assay score",
fill = "Number assayed") +
theme_bw() +
scale_fill_viridis_c()
)
ggplot() +
geom_density_ridges2(data=selected_seedlot_rustassay_score_allrepo, colour="grey40", aes(x = Seedling_score_rustassay, y=Seedlot, fill=Seedling_number_rustassay, alpha = 0.7)) +
geom_segment(data = mean_matLine_GenomPred, aes(x = Mean_seedling_score_genompred, xend = Mean_seedling_score_genompred, y = as.numeric(factor(Seedlot)) + 0.2, yend = as.numeric(factor(Seedlot)) + 0.8), colour = "orchid", linewidth = 0.5, linetype="dashed") +
geom_segment(data = mean_matLine_MatLineGenomPred, aes(x = MatLine_Genompred, xend = MatLine_Genompred, y = as.numeric(factor(Seedlot)) + 0.2, yend = as.numeric(factor(Seedlot)) + 0.8), colour = "blue", linewidth = 0.5, linetype="dashed") +
labs(title = "Characterising rust resistance assay scores",
subtitle="Blue dashed line represents mean seedling genomic prediction score of seed lot\n Purple dashed line represents the maternal line's genomic prediction score",
y = "Seed lot ID",
x = "Raw assay score",
fill = "Number assayed") +
theme_bw() +
scale_fill_viridis_c()
## Plot of seedlots characteristics
observe(
# selected_seedlots=NULL; selected_seedlots$seedlot_ID <- unique(mat_line_genompred_score$Seedlot)[1:5]
selected_seedlot_rustassay_score_allrepo <- left_join(mat_line_rustassay_score, LoadedinData) %>%
dplyr::filter(Seedlot %in% selected_seedlots$seedlot_ID),
mean_matLine_RustAssay <- selected_seedlot_rustassay_score_allrepo %>%
dplyr::select(Seedlot, Mean_seedling_score_rustassay) %>%
dplyr::distinct(),
selected_seedlot_genompred_score_allrepo <- left_join(mat_line_genompred_score, LoadedinData) %>%
dplyr::filter(Seedlot %in% selected_seedlots$seedlot_ID),
mean_matLine_GenomPred <- selected_seedlot_rustassay_score_allrepo %>%
dplyr::select(Seedlot, Mean_seedling_score_genompred) %>%
dplyr::distinct(),
mean_matLine_MatLineGenomPred <- selected_seedlot_rustassay_score_allrepo %>%
dplyr::select(Seedlot, MatLine_Genompred) %>%
dplyr::distinct(),
output$seedlot_plot_geomridge <- ggplot() +
geom_density_ridges2(data=selected_seedlot_rustassay_score_allrepo, colour="grey40", aes(x = Seedling_score_rustassay, y=Seedlot, fill=Seedling_number_rustassay, alpha = 0.7)) +
geom_segment(data = mean_matLine_RustAssay, aes(x = Mean_seedling_score_rustassay, xend = Mean_seedling_score_rustassay, y = as.numeric(factor(Seedlot)) + 0.2, yend = as.numeric(factor(Seedlot)) + 0.8), colour = "red", linewidth = 0.5, linetype="dashed") +
labs(title = "Characterising rust resistance assay scores",
subtitle="Red dashed line represents mean seedling rust assay score of seed lot",
y = "Seed lot ID",
x = "Raw assay score",
fill = "Number assayed") +
theme_bw() +
scale_fill_viridis_c(),
output$seedlot_plot_geomridge <- ggplot() +
geom_density_ridges2(data=selected_seedlot_rustassay_score_allrepo, colour="grey40", aes(x = Seedling_score_rustassay, y=Seedlot, fill=Seedling_number_rustassay, alpha = 0.7)) +
geom_segment(data = mean_matLine_GenomPred, aes(x = Mean_seedling_score_genompred, xend = Mean_seedling_score_genompred, y = as.numeric(factor(Seedlot)) + 0.2, yend = as.numeric(factor(Seedlot)) + 0.8), colour = "orchid", linewidth = 0.5, linetype="dashed") +
geom_segment(data = mean_matLine_MatLineGenomPred, aes(x = MatLine_Genompred, xend = MatLine_Genompred, y = as.numeric(factor(Seedlot)) + 0.2, yend = as.numeric(factor(Seedlot)) + 0.8), colour = "blue", linewidth = 0.5, linetype="dashed") +
labs(title = "Characterising rust resistance assay scores",
subtitle="Blue dashed line represents mean seedling genomic prediction score of seed lot\n Purple dashed line represents the maternal line's genomic prediction score",
y = "Seed lot ID",
x = "Genomic prediction score",
fill = "Number assayed") +
theme_bw() +
scale_fill_viridis_c()
)
mean_matLine_GenomPred <- selected_seedlot_rustassay_score_allrepo %>%
dplyr::select(Seedlot, Mean_seedling_score_genompred) %>%
dplyr::distinct()
mean_matLine_MatLineGenomPred <- selected_seedlot_rustassay_score_allrepo %>%
dplyr::select(Seedlot, MatLine_Genompred) %>%
dplyr::distinct(),
mean_matLine_MatLineGenomPred <- selected_seedlot_rustassay_score_allrepo %>%
dplyr::select(Seedlot, MatLine_Genompred) %>%
dplyr::distinct()
selected_seedlot_genompred_score_allrepo <- left_join(mat_line_genompred_score, LoadedinData) %>%
dplyr::filter(Seedlot %in% selected_seedlots$seedlot_ID)
ggplot() +
geom_density_ridges2(data=selected_seedlot_rustassay_score_allrepo, colour="grey40", aes(x = Seedling_score_rustassay, y=Seedlot, fill=Seedling_number_rustassay, alpha = 0.7)) +
geom_segment(data = mean_matLine_GenomPred, aes(x = Mean_seedling_score_genompred, xend = Mean_seedling_score_genompred, y = as.numeric(factor(Seedlot)) + 0.2, yend = as.numeric(factor(Seedlot)) + 0.8), colour = "orchid", linewidth = 0.5, linetype="dashed") +
geom_segment(data = mean_matLine_MatLineGenomPred, aes(x = MatLine_Genompred, xend = MatLine_Genompred, y = as.numeric(factor(Seedlot)) + 0.2, yend = as.numeric(factor(Seedlot)) + 0.8), colour = "blue", linewidth = 0.5, linetype="dashed") +
labs(title = "Characterising rust resistance assay scores",
subtitle="Blue dashed line represents mean seedling genomic prediction score of seed lot\n Purple dashed line represents the maternal line's genomic prediction score",
y = "Seed lot ID",
x = "Genomic prediction score",
fill = "Number assayed") +
theme_bw() +
scale_fill_viridis_c()
ggplot() +
geom_density_ridges2(data=selected_seedlot_rustassay_score_allrepo, colour="grey40", alpha = 0.9, aes(x = Seedling_score_rustassay, y=Seedlot, fill=Seedling_number_rustassay, alpha = 0.7)) +
geom_segment(data = mean_matLine_RustAssay, aes(x = Mean_seedling_score_rustassay, xend = Mean_seedling_score_rustassay, y = as.numeric(factor(Seedlot)) + 0.2, yend = as.numeric(factor(Seedlot)) + 0.8), colour = "red", linewidth = 0.5, linetype="dashed") +
labs(title = "Characterising rust resistance assay scores",
subtitle="Red dashed line represents mean seedling rust assay score of seed lot",
y = "Seed lot ID",
x = "Raw assay score",
fill = "Number assayed") +
theme_bw() +
scale_fill_viridis_c()
ggplot() +
geom_density_ridges2(data=selected_seedlot_rustassay_score_allrepo, colour="grey40", alpha = 0.9, aes(x = Seedling_score_rustassay, y=Seedlot, fill=Seedling_number_rustassay)) +
geom_segment(data = mean_matLine_GenomPred, aes(x = Mean_seedling_score_genompred, xend = Mean_seedling_score_genompred, y = as.numeric(factor(Seedlot)) + 0.2, yend = as.numeric(factor(Seedlot)) + 0.8), colour = "orchid", linewidth = 0.5, linetype="dashed") +
geom_segment(data = mean_matLine_MatLineGenomPred, aes(x = MatLine_Genompred, xend = MatLine_Genompred, y = as.numeric(factor(Seedlot)) + 0.2, yend = as.numeric(factor(Seedlot)) + 0.8), colour = "blue", linewidth = 0.5, linetype="dashed") +
labs(title = "Characterising rust resistance assay scores",
subtitle="Blue dashed line represents mean seedling genomic prediction score of seed lot\nPurple dashed line represents the maternal line's genomic prediction score",
y = "Seed lot ID",
x = "Genomic prediction score",
fill = "Number assayed") +
theme_bw() +
scale_fill_viridis_c()
ggplot() +
geom_density_ridges2(data=selected_seedlot_rustassay_score_allrepo, colour="grey40", alpha = 0.9, aes(x = Seedling_score_rustassay, y=Seedlot, fill=Seedling_number_rustassay)) +
geom_segment(data = mean_matLine_GenomPred, aes(x = Mean_seedling_score_genompred, xend = Mean_seedling_score_genompred, y = as.numeric(factor(Seedlot)) + 0.2, yend = as.numeric(factor(Seedlot)) + 0.8), colour = "green", linewidth = 0.5, linetype="dashed") +
geom_segment(data = mean_matLine_MatLineGenomPred, aes(x = MatLine_Genompred, xend = MatLine_Genompred, y = as.numeric(factor(Seedlot)) + 0.2, yend = as.numeric(factor(Seedlot)) + 0.8), colour = "blue", linewidth = 0.5, linetype="dotted") +
labs(title = "Characterising rust resistance assay scores",
subtitle="Blue dashed line represents mean seedling genomic prediction score of seed lot\nGreen dotted line represents the maternal line's genomic prediction score",
y = "Seed lot ID",
x = "Genomic prediction score",
fill = "Number assayed") +
theme_bw() +
scale_fill_viridis_c()
ggplot() +
geom_density_ridges2(data=selected_seedlot_rustassay_score_allrepo, colour="grey40", alpha = 0.9, aes(x = Seedling_score_rustassay, y=Seedlot, fill=Seedling_number_rustassay)) +
geom_segment(data = mean_matLine_GenomPred, aes(x = Mean_seedling_score_genompred, xend = Mean_seedling_score_genompred, y = as.numeric(factor(Seedlot)) + 0.2, yend = as.numeric(factor(Seedlot)) + 0.8), colour = "green", linewidth = 0.5, linetype="dotted") +
geom_segment(data = mean_matLine_MatLineGenomPred, aes(x = MatLine_Genompred, xend = MatLine_Genompred, y = as.numeric(factor(Seedlot)) + 0.2, yend = as.numeric(factor(Seedlot)) + 0.8), colour = "blue", linewidth = 0.5, linetype="dashed") +
labs(title = "Characterising rust resistance assay scores",
subtitle="Blue dashed line represents mean seedling genomic prediction score of seed lot\nGreen dotted line represents the maternal line's genomic prediction score",
y = "Seed lot ID",
x = "Genomic prediction score",
fill = "Number assayed") +
theme_bw() +
scale_fill_viridis_c()
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
setwd("~/Uni/Doctorate/Samples/Seedlot_plot_data/")
# Load in datasets used
## Files for report gen (keep at top)
source(file = "Seedlot_plot_ShinyMap/Seedlot_plot_shiny.R")
LoadedinData <- read.csv("data/final_seedloty_plot.csv") %>% unique()
LoadedinData <- LoadedinData[!duplicated(LoadedinData$Seedlot),]
# Load current projection data
maxent_MQuin <- raster("data/maxent_MQuin.tiff")
maxent_MR <- raster("data/maxent_MR.tiff")
maxent_intersection <- raster("data/maxent_intersection.tiff")
maxent_studyarea <- st_read("data/maxent_studyarea.gpkg")
MQ_observations <- read.csv("data/MQ_locs_clean.csv"); MQ_observations <- MQ_observations[,2:3]
MR_observations <- read.csv("data/MR_locs_clean.csv"); MR_observations <- MR_observations[,2:3]
# Load future projection data
years_clust <- c("2021-2040", "2041-2060", "2061-2080")
ssp_list <- c("126", "245", "370", "585")
for (species in c("MQuin", "MR")){
for (cluster in years_clust){
for (ssp in ssp_list){
read_file <- raster(paste0("data/maxent_",species, cluster, "_", ssp, ".tiff"))
assign(paste0("maxent_",species, cluster, "_", ssp), read_file)
}
}
}
runApp('Seedlot_plot_ShinyMap')
options(shiny.error = browser)
runApp()
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
?conditionalPanel
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
library(readxl)
runApp('Seedlot_plot_ShinyMap')
?plotOutput
report_plotheight <- 10*length(selected_seedlots$seedlot_ID)
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
LoadedinData <- read.csv("data/final_seedloty_plot.csv") %>% unique()
LoadedinData <- LoadedinData[!duplicated(LoadedinData$Seedlot),]
View(LoadedinData)
?geom_density_ridges2
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
LoadedinData <- read.csv("data/final_seedloty_plot.csv") %>% unique()
LoadedinData <- LoadedinData[!duplicated(LoadedinData$Seedlot),]
View(LoadedinData)
names(LoadedinData)
## Seedlot_plot.R for shiny - Dated:28-11-2025
## Creating spreadsheet
### Prev project
seedlings_all <- read.csv ("data/Mquin_samples_pheno.csv") # Meta data for seedlings including height and COI of all seedlings, including those that didn't get genotypes
mat_line_rustassay_score <- seedlings_all %>% dplyr::select(FID, COI) %>% group_by(FID) %>% mutate(Seedling_number_rustassay = n()) %>% unique()
colnames(mat_line_rustassay_score) <- (c("Seedlot", "Seedling_score_rustassay", "Seedling_number_rustassay"))
mat_line_meta <- seedlings_all %>% dplyr::select(FID, Lat, Long) %>% group_by(FID) %>% unique()
colnames(mat_line_meta) <- (c("Seedlot", "Latitude", "Longitude"))
### Adults from Prev project
parent_meta_lib <- read.csv ("data/parent_meta.csv") %>%
dplyr::select(NSWID, sample_lib_NSW)
Mat_line_droughttol <- read.csv(file = "data/GAPIT49_prediction_gt.csv")
colnames(Mat_line_droughttol)[1] <- 'sample_lib_NSW'
Mat_line_droughttol <- left_join(Mat_line_droughttol, parent_meta_lib) %>%
dplyr::select (NSWID, Prediction)
Mat_line_droughttol_rmdup <- Mat_line_droughttol[!duplicated(Mat_line_droughttol$NSWID), ]
colnames(Mat_line_droughttol_rmdup) <- c("Seedlot", "MatLine_Genompred")
mat_line_meta <- left_join(mat_line_meta, Mat_line_droughttol_rmdup)
## Add in drought seedling predictions individuals
sample_meta_drought <- readxl::read_xlsx("data/All_samples.xlsx") %>% filter(!is.na(NSWID) & `Genotyping Purpose`=="Drought_experiment") %>% dplyr::select(NSWID, Drought_Exp_ID)
colnames(sample_meta_drought)[2] <- c("IID"); sample_meta_drought$IID <- as.numeric(sample_meta_drought$IID)
prediction_gt <- read.csv("data/Report10753_prediction_gt_main.csv") %>% dplyr::select(c(Taxa, PEV, Prediction))
colnames(prediction_gt)[1] <- "NSWID"
prediction_gt_droughtexp <- inner_join(prediction_gt, sample_meta_drought, by="NSWID")
prediction_gt_droughtexp_rmpoorsamp <- prediction_gt_droughtexp %>% filter(PEV < 0.5)
IID_block <- readxl::read_xlsx(path="data/FID Selection & ID & Randomisation_vers1.xlsx", sheet = 'real_IID_Block_Cell_12tray') %>%  select(IID, Mat_Line)
IID_block <- left_join(IID_block, sample_meta_drought)
prediction_gt_droughtexp_rmpoorsamp <- left_join(IID_block, prediction_gt_droughtexp_rmpoorsamp) %>%
filter(!is.na(Prediction)) %>%
select(-c(NSWID))
# Add in GP from iter 48
iter_48_GP <- read.csv("data/GAPIT48_prediction_gt.csv"); colnames(iter_48_GP)[1] <- "LIBRARY"
prev_exp_pedi <- read.csv("data/prev_exp_pedi.csv")
prev_exp_pedi$FID <- gsub ("_", "", prev_exp_pedi$FID)
iter_48_GP_pedi <- left_join(iter_48_GP, prev_exp_pedi) %>%
select(LIBRARY, FID, Prediction, PEV)
colnames(prediction_gt_droughtexp_rmpoorsamp) <- c("LIBRARY", "FID", "Prediction", "PEV")
mat_line_genompred_score <- rbind(prediction_gt_droughtexp_rmpoorsamp, iter_48_GP_pedi) %>%
group_by(FID) %>%
mutate(Seedling_number_genompred = n()) %>%
select(FID, Prediction, Seedling_number_genompred)
colnames(mat_line_genompred_score) <- c("Seedlot", "Seedling_score_genompred", "Seedling_number_rustassay")
mat_line_genompred_score$Seedling_score_genompred[mat_line_genompred_score$Seedling_score_genompred<0] = 0
## Final plot datasets
mat_line_rustassay_score <- left_join(mat_line_meta, mat_line_rustassay_score)
mat_line_genompred_score <- left_join(mat_line_meta, mat_line_genompred_score)
final_ds <- c("mat_line_rustassay_score"
View(mat_line_genompred_score)
names(mat_line_genompred_score)
runApp('Seedlot_plot_ShinyMap')
View(mat_line_genompred_score)
names(mat_line_genompred_score)
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
?geom_density_ridges2
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
View(mat_line_genompred_score)
runApp('Seedlot_plot_ShinyMap')
LoadedinData <- read.csv("data/final_seedloty_plot.csv") %>% unique()
LoadedinData <- LoadedinData[!duplicated(LoadedinData$Seedlot),]
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
?addCircleMarkers
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
LoadedinData <- read.csv("data/final_seedloty_plot.csv") %>% unique()
LoadedinData <- LoadedinData[!duplicated(LoadedinData$Seedlot),]
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
LoadedinData <- read.csv("data/final_seedloty_plot.csv") %>% unique()
LoadedinData <- LoadedinData[!duplicated(LoadedinData$Seedlot),]
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
setwd("~/Uni/Doctorate/Samples/Seedlot_plot_data/")
# Load in datasets used
## Files for report gen (keep at top)
source(file = "Seedlot_plot_ShinyMap/Seedlot_plot_shiny.R")
LoadedinData <- read.csv("data/final_seedloty_plot.csv") %>% unique()
LoadedinData <- LoadedinData[!duplicated(LoadedinData$Seedlot),]
# Load current projection data
maxent_MQuin <- raster("data/maxent_MQuin.tiff")
maxent_MR <- raster("data/maxent_MR.tiff")
maxent_intersection <- raster("data/maxent_intersection.tiff")
maxent_studyarea <- st_read("data/maxent_studyarea.gpkg")
MQ_observations <- read.csv("data/MQ_locs_clean.csv"); MQ_observations <- MQ_observations[,2:3]
MR_observations <- read.csv("data/MR_locs_clean.csv"); MR_observations <- MR_observations[,2:3]
# Load future projection data
years_clust <- c("2021-2040", "2041-2060", "2061-2080")
ssp_list <- c("126", "245", "370", "585")
for (species in c("MQuin", "MR")){
for (cluster in years_clust){
for (ssp in ssp_list){
read_file <- raster(paste0("data/maxent_",species, cluster, "_", ssp, ".tiff"))
assign(paste0("maxent_",species, cluster, "_", ssp), read_file)
}
}
}
for (cluster in years_clust){
for (ssp in ssp_list){
read_file <- raster(paste0("data/future_maxent_intersection", cluster, "_", ssp, ".tiff"))
assign(paste0("maxent_intersection", cluster, "_", ssp), read_file)
}
}
##
date=Sys.Date()
# Palettes
# For seedlots based on severity - actively shifts based on observed data
MR_Sev_pal <- colorNumeric(
palette = "YlOrRd",  # Yellow → Orange → Red
domain = LoadedinData$Mean_seedling_score_rustassay,
na.color = "gray50"
)
# For SDMs
pal_mr <- colorRampPalette(c("grey95","#C6DC96","#C6DC96","darkolivegreen","yellow"))
pal_mq <- colorRampPalette(c("grey95","#EAC8BF","#EAC8BF","orange","forestgreen"))
pal_int <- colorRampPalette(c("grey95","#C6DC96","#C6DC96","#45B055","#4870BD", "deeppink4"))
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
selected_seedlot_data_allrepo
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
MR_observations <- read.csv("data/MR_locs_clean.csv"); MR_observations <- MR_observations[,2:3]
View(MR_observations)
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
cat(length(selected_seedlots$seedlot_ID)>0)
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
colnames (data_repo) <- c("Seedlot", "Lat", "Long", "N", "Mean_score", "Sd_score")
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
runApp('Seedlot_plot_ShinyMap')
